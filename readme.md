# Today in History Plugin

<div align="center">

<a href="https://www.python.org">
    <img src="https://img.shields.io/badge/Python-3.10%20%7C%203.11%20%7C%203.12-blue" alt="python">
</a>
<a href="https://onebot.dev/">
  <img src="https://img.shields.io/badge/OneBot-v11-black?style=social&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABABAMAAABYR2ztAAAAIVBMVEUAAAAAAAADAwMHBwceHh4UFBQNDQ0ZGRkoKCgvLy8iIiLWSdWYAAAAAXRSTlMAQObYZgAAAQVJREFUSMftlM0RgjAQhV+0ATYK6i1Xb+iMd0qgBEqgBEuwBOxU2QDKsjvojQPvkJ/ZL5sXkgWrFirK4MibYUdE3OR2nEpuKz1/q8CdNxNQgthZCXYVLjyoDQftaKuniHHWRnPh2GCUetR2/9HsMAXyUT4/3UHwtQT2AggSCGKeSAsFnxBIOuAggdh3AKTL7pDuCyABcMb0aQP7aM4AnAbc/wHwA5D2wDHTTe56gIIOUA/4YYV2e1sg713PXdZJAuncdZMAGkAukU9OAn40O849+0ornPwT93rphWF0mgAbauUrEOthlX8Zu7P5A6kZyKCJy75hhw1Mgr9RAUvX7A3csGqZegEdniCx30c3agAAAABJRU5ErkJggg==" alt="onebot">
</a>
<a href="https://bot.q.qq.com/wiki/">
  <img src="https://img.shields.io/badge/QQ-Bot-lightgrey?style=social&logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMTIuODIgMTMwLjg5Ij48ZyBkYXRhLW5hbWU9IuWbvuWxgiAyIj48ZyBkYXRhLW5hbWU9IuWbvuWxgiAxIj48cGF0aCBkPSJNNTUuNjMgMTMwLjhjLTcgMC0xMy45LjA4LTIwLjg2IDAtMTkuMTUtLjI1LTMxLjcxLTExLjQtMzQuMjItMzAuMy00LjA3LTMwLjY2IDE0LjkzLTU5LjIgNDQuODMtNjYuNjQgMi0uNTEgNS4yMS0uMzEgNS4yMS0xLjYzIDAtMi4xMy4xNC0yLjEzLjE0LTUuNTcgMC0uODktMS4zLTEuNDYtMi4yMi0yLjMxLTYuNzMtNi4yMy03LjY3LTEzLjQxLTEtMjAuMTggNS40LTUuNTIgMTEuODctNS40IDE3LjgtLjU5IDYuNDkgNS4yNiA2LjMxIDEzLjA4LS44NiAyMS0uNjguNzQtMS43OCAxLjYtMS43OCAyLjY3djQuMjFjMCAxLjM1IDIuMiAxLjYyIDQuNzkgMi4zNSAzMS4wOSA4LjY1IDQ4LjE3IDM0LjEzIDQ1IDY2LjM3LTEuNzYgMTguMTUtMTQuNTYgMzAuMjMtMzIuNyAzMC42My04LjAyLjE5LTE2LjA3LS4wMS0yNC4xMy0uMDF6IiBmaWxsPSIjMDI5OWZlIi8+PHBhdGggZD0iTTMxLjQ2IDExOC4zOGMtMTAuNS0uNjktMTYuOC02Ljg2LTE4LjM4LTE3LjI3LTMtMTkuNDIgMi43OC0zNS44NiAxOC40Ni00Ny44MyAxNC4xNi0xMC44IDI5Ljg3LTEyIDQ1LjM4LTMuMTkgMTcuMjUgOS44NCAyNC41OSAyNS44MSAyNCA0NS4yOS0uNDkgMTUuOS04LjQyIDIzLjE0LTI0LjM4IDIzLjUtNi41OS4xNC0xMy4xOSAwLTE5Ljc5IDAiIGZpbGw9IiNmZWZlZmUiLz48cGF0aCBkPSJNNDYuMDUgNzkuNThjLjA5IDUgLjIzIDkuODItNyA5Ljc3LTcuODItLjA2LTYuMS01LjY5LTYuMjQtMTAuMTktLjE1LTQuODItLjczLTEwIDYuNzMtOS44NHM2LjM3IDUuNTUgNi41MSAxMC4yNnoiIGZpbGw9IiMxMDlmZmUiLz48cGF0aCBkPSJNODAuMjcgNzkuMjdjLS41MyAzLjkxIDEuNzUgOS42NC01Ljg4IDEwLTcuNDcuMzctNi44MS00LjgyLTYuNjEtOS41LjItNC4zMi0xLjgzLTEwIDUuNzgtMTAuNDJzNi41OSA0Ljg5IDYuNzEgOS45MnoiIGZpbGw9IiMwODljZmUiLz48L2c+PC9nPjwvc3ZnPg==" alt="QQ">
</a>
<br>
<a href="https://www.codefactor.io/repository/github/cg8-5712/qbot-plugin-history/">
    <img src="https://www.codefactor.io/repository/github/cg8-5712/qbot-plugin-history/badge" alt="CodeFactor" />
</a>
<a href="./LICENSE">
    <img src="https://img.shields.io/badge/license-GPL--3.0-green" alt="license">
</a>
<a href="https://github.com/cg8-5712/qbot-plugin-history/activity">
    <img src="https://img.shields.io/github/last-commit/cg8-5712/qbot-plugin-history/main" alt="Last Commit">
</a>

</div>

## Overview

A Zhenxun Bot plugin that shows historical events related to aviation and computer fields for the current date. Events are fetched from web sources and filtered using GPT for relevance verification.

## Features

- Query historical events with text or image output
- Daily automatic push notifications to subscribed groups
- Event filtering for aviation/computer relevance using GPT
- Event caching system to reduce API calls
- HTML template rendering for beautiful image output

## Installation

1. Place the plugin files in your Zhenxun Bot plugins directory:
```bash
cd zhenxun/plugins/
git clone https://github.com/cg8-5712/qbot-plugin-history.git
```

2. Install required dependencies:
```bash
pip install -r requirements.txt
```

3. Configure the template path in your Zhenxun Bot:
```
zhenxun_bot\resources\template\history
```

## Usage

### Commands
- Query with image output:
```
@Bot 历史上的今天
@Bot history
@Bot his
```

- Query with text output:
```
@Bot 历史上的今天 --raw
@Bot history --raw
@Bot his --raw
```

### Auto Push
The plugin automatically pushes events to subscribed groups at 12:00 every day.

### Configuration
In `config.yaml`: (This file usually in )
```yaml
history:
  CACHE_TIME: 7           # Cache duration in days (0 for permanent)
  SUBSCRIBE_GROUPS: []    # List of group IDs for auto push
```

## Output Format

### Image Output
The image output includes:
- Current date and time
- Highlighted events (aviation/computer related)
- Other historical events
- Visual styling with HTML template

### Text Output
- Section for highlighted events
- Section for other events
- Simple text formatting

## Dependencies
- [zhenxun_bot](https://github.com/zhenxun-org/zhenxun_bot)
- Python 3.10+
- nonebot2
- nonebot-plugin-htmlrender
- nonebot-plugin-alconna
- nonebot-plugin-apscheduler
- openai
- lxml
- aiohttp

## License
GNU General Public License v3.0 This project is licensed under the terms of the GNU General Public License v3.0. See the [LICENSE](./LICENSE) file for details.

## Author
[cg8-5712](https://github.com/cg8-5712)

## Version
1.0.0

## Contributing
Feel free to submit issues and pull requests to improve this plugin.

## Notes
This plugin uses OpenAI's GPT API to verify event relevance. Please ensure you have configured a valid API key.
